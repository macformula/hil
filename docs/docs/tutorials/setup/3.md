# Creating ECU Objects

Since our `pinout.Controller` and `canlink.BusManager` will be frequently queried throughout a SIL test, its useful to wrap them with a higher level struct, with methods that explicitly read and set I/O. 
This abstraction encapsulates all of an ECU's input and output into a struct for easier lookup. Each test state will use this ECU object to test for certain conditions.

## Client struct

Inside the `sil/ecu` folder create a folder called `DemoController`, and create a file in this folder called `client.go`.
Mark this file as a Go module called `DemoController`, with a `Client` struct. 

```go
package democontroller

import (
	"go.uber.org/zap"

	"github.com/macformula/hil/canlink"
	"github.com/sil/pinout"
	"github.com/pkg/errors"
)

const (
	_clientName = "demo_controller_client"
)

type Client struct {
	l             *zap.Logger
	pinController *pinout.Controller
}

// NewClient creates a new demo controller client.
func NewClient(pinController *pinout.Controller, l *zap.Logger) *Client {
	return &Client{
		l:             l.Named(_clientName),
		pinController: pinController,
	}
}
```

One operation our firmware code will preform frequently is reading the signal of the `IndicatorLed`.
Implement a `ReadIndicatorLed` method that queries the `Client.pinController` for the `IndicatorLed`, then ensures the operation was successful. 

```go
func (c *Client) ReadIndicatorLed() (bool, error) {
	lvl, err := c.pinController.ReadDigitalLevel(pinout.IndicatorLed)
	if err != nil {
		return false, errors.Wrap(err, "read digital level (indicator led)")
	}

	return lvl, nil
}
```

A similar function can be implemented to set the `indicatorButton`.

```go
func (c *Client) SetIndicatorButton(value bool) error {
	err := c.pinController.SetDigitalLevel(pinout.IndicatorButton, value)
	if err != nil {
		return errors.Wrap(err, "set digital level (indicator button)")
	}

	return nil
}
```

This `Client` struct is now complete and test states can use it to preform I/O operations on the `demoController`. Although our example ECU contains no CAN bus I/O, a `Client` struct may also have a field for a `busManager` to call the `busManager.Send` method in order to transmit frames back onto the bus.