# Test States 

`macfe/hil` organizes testing logic using `Sequence`'s, `State`'s and `Tag`'s. A `Sequence` 
is a high level struct that contains an array of `State`'s that are run in the order provided. 
During a `State`, our SIL will alter certain inputs to firmware, 
then verify the response is correct by checking output pins. A `State` may 
also send messages across the virtual CAN bus, and ensure firmware responds 
accordingly. The results from a SIL test are organized by `Tag`'s. These contain a high level 
description of simple properties that can be validated by a `State`.

## State

Let's create a new state called `demoState` inside the `sil/state/demo.go` folder.

```go
package state

import (
	"context"
	"errors"
	"time"

	"github.com/macformula/hil/flow"
)

const (
	_name = "demo_test_state"
)

type demoState struct {
	l  *zap.Logger
	a  *macformula.App
	dc *democontroller.Client

	fatalErr utils.ResettableError

	results map[flow.Tag]any
}

func newDemoState(l *zap.logger, a *macformula.App) *demoState {
	return &demoState{
        l: l,
        a: a,
        dc: a.DemoControllerClient,

        results: map[flow.Tag]any{},
    }
}

func (d *demoState) GetResults() map[flow.Tag]any {
	return d.results
}

func (d *demoState) ContinueOnFail() bool {
	return true
}

// Timeout returns the state setup and run timeout.
func (d *demoState) Timeout() time.Duration {
	return time.Minute
}

// Setup executes any necessary setup logic before run.
func (d *demoState) Setup(ctx context.Context) error {
	n.setupCalled = true

	return nil
}

// Name is the name of the state.
func (d *demoState) Name() string {
	return _name
}

// Run is the logic that gets executed after setup.
func (d *demoState) Run(_ context.Context) error {
	return nil
}

// FatalError indicates if any non-recoverable errors have occured.
func (d *demoState) FatalError() error {
	return d.fatalErr
}
```

!!! info 
    Even though some of these methods will not be used for every `State`, they must be defined in order for `demoState` to implement the `State` interface.

## State logic

Now that our initial `demoState` is defined, we can add testing logic inside the `Run` method. For our example, 